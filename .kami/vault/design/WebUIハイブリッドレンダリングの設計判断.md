---
title: WebUIハイブリッドレンダリングの設計判断
tags:
  - webui
created: '2026-02-15T22:59:24.917Z'
updated: '2026-02-15T22:59:24.917Z'
template: note
---

## WebUI ハイブリッドレンダリング方式の設計判断

### ADR: 静的ビルド + SSR のハイブリッド方式を採用

### 背景
WebUI のレンダリング方式として以下の3つを検討した:
1. **完全静的ビルド**: `kami build` で全ページを事前生成（REQUIREMENTS.md の元案）
2. **完全SSR**: Hono サーバーが全ページをリクエスト時にレンダリング
3. **ハイブリッド**: 閲覧系は静的、編集/検索系は SSR

### 決定
**ハイブリッド方式**を採用。

### 理由
- **閲覧ページ（静的）**: 記事閲覧は最も頻繁なアクセスパターン。静的HTMLなら配信のみで最速。CDN配信も可能
- **編集/検索ページ（SSR）**: 常に最新データが必要。ビルド待ちなしで即時反映
- **CLIとの統合**: `kami build` で静的HTML出力する既存CLI仕様を活かせる
- **リソース効率**: サーバーリソースは動的ページに集中

### ビルドパイプライン構成

調査の結果、以下の構成を採用:
1. **CSS**: `@tailwindcss/cli` で独立ビルド（Vite pluginはSSRとの相性問題あり）→ [[TailwindCSS v4のCSS-first設定とSSRでの注意点]]
2. **クライアントJS**: Vite でバンドル（編集画面の部分ハイドレーション用のみ）
3. **静的HTML**: Bun上で `ReactDOMServer.renderToString` を直接実行
4. **サーバー**: Bun がTSXを直接実行。サーバーのビルドステップは不要 → [[Hono + React SSR on Bunの構成パターン]]

### トレードオフ
- (+) 閲覧が高速
- (+) 編集/検索が常に最新
- (-) 記事変更時に静的ページの再ビルドが必要（API経由で自動再ビルド）
- (-) ビルドパイプラインが CSS + JS + HTML の3ステップに分かれ、やや複雑

